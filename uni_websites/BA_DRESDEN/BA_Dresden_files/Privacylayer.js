"use strict";function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _iterableToArray(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(a,b){b=b||window;for(var c=0;c<this.length;c++)a.call(b,this[c],c,this)}),function(){return"function"!=typeof window.CustomEvent&&void(window.CustomEvent=function(a,b){b=b||{bubbles:!1,cancelable:!1,detail:null};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c})}(),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(a){var b=this;do{if(Element.prototype.matches.call(b,a))return b;b=b.parentElement||b.parentNode}while(null!==b&&1===b.nodeType);return null}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function value(a,b){var d=Math.max,e=Math.abs;function c(a,b){return a===b||"number"==typeof a&&"number"==typeof b&&isNaN(a)&&isNaN(b)}if(null==this)throw new TypeError("\"this\" is null or not defined");var f=Object(this),g=f.length>>>0;if(0===g)return!1;for(var h=0|b,i=d(0<=h?h:g-e(h),0);i<g;){if(c(f[i],a))return!0;i++}return!1}}),function(a){var b;a&&a.initialized||(a=new(b=function(){function a(){_classCallCheck(this,a),_defineProperty(this,"initialized",!1),_defineProperty(this,"container",void 0),_defineProperty(this,"availableGroups",[]),_defineProperty(this,"options",null),_defineProperty(this,"defaultOptions",{cookiename:"privacylayer",lifetime:31536000,path:"/",sameSite:"None",secure:!0,pageReload:!1,triggerSelector:".cc_privacy_show"}),_defineProperty(this,"currentGroups",[]),_defineProperty(this,"helper",{_context:this,gC:function gC(a){var b=("; "+document.cookie).split("; "+a+"=");return 2===b.length?(b.pop()||"").split(";").shift():""},sC:function sC(a,b,c){var d=a+"="+b+";max-age="+c+";path="+this.gO("path")+";sameSite="+this.gO("sameSite");this.gO("secure")&&(d+=";Secure"),document.cookie=d},gO:function gO(a){return null===this._context.options&&(this._context.options=window.privacylayer_options||{}),void 0===this._context.options[a]?this._context.defaultOptions[a]:this._context.options[a]},sE:function sE(a){return a.preventDefault(),a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation(),!1},cE:function cE(a){var b=new CustomEvent("PrivacylayerChange",{cancelable:!0,detail:{groups:a}});return document.dispatchEvent(b)}})}return _createClass(a,[{key:"init",value:function init(){var a=this;if(this.availableGroups=[],this.container=this.container||document.querySelector("#cc_privacy_layer"),null!==this.container){this.container.querySelector(".cc_open_settings").addEventListener("click",function(){a.container.querySelector("#cc_privacy_box").classList.add("cc_show_settings")}),this.container.querySelectorAll(".cc_accept_all").forEach(function(b){b.addEventListener("click",function(){a.accept("*")})}),this.container.querySelector(".cc_accept_settings").addEventListener("click",function(){var b=[];a.container.querySelectorAll(".cc_choose_settings .cc_checkbox[data-group] input[type=checkbox]:checked").forEach(function(a){b.push(a.closest(".cc_checkbox[data-group]").dataset.group)}),a.accept.apply(a,b)}),this.container.querySelectorAll(".cc_choose_settings .cc_checkbox[data-group]").forEach(function(b){var c=b;a.availableGroups.push(b.dataset.group),null!==b.querySelector("input[checked]")&&a.currentGroups.push(b.dataset.group),b.querySelector(".cc_show_details").addEventListener("click",function(){c.classList.contains("cc_active")?c.classList.remove("cc_active"):c.classList.add("cc_active")})});var b=this.helper.gO("triggerSelector")||"";b&&document.querySelectorAll(b).forEach(function(b){b.addEventListener("click",function(b){b.preventDefault(),a.show()})})}}},{key:"show",value:function show(){this.container.classList.add("cc_active")}},{key:"hide",value:function hide(){this.container.classList.remove("cc_active")}},{key:"accept",value:function accept(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=this;this.acceptWithoutAction.apply(this,b)&&(this.helper.gO("pageReload")?location.reload():(this.hide(),b.includes("*")?document.querySelectorAll(".cc_privacy_provider").forEach(function(a){d.enableIntegration(a,!1)}):this.availableGroups.forEach(function(a){var c=b.includes(a);document.querySelectorAll(".cc_privacy_provider[data-privacy-group=\""+a+"\"]").forEach(function(a){c?d.enableIntegration(a,!1):d.disableIntegration(a)})})))}},{key:"acceptWithoutAction",value:function acceptWithoutAction(){for(var a=this,b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];if(c=c.includes("*")?this.availableGroups:c.filter(function(b){return a.availableGroups.includes(b)}),this.helper.cE(c)){this.currentGroups=c,this.helper.sC(this.helper.gO("cookiename"),JSON.stringify({groups:c}),this.helper.gO("lifetime"));var e=this;return c.includes("*")?this.container.querySelectorAll(".cc_choose_settings .cc_checkbox[data-group] input[type=checkbox]").forEach(function(a){a.checked=!0}):this.availableGroups.forEach(function(a){var b=c.includes(a);e.container.querySelectorAll(".cc_choose_settings .cc_checkbox[data-group=\""+a+"\"] input[type=checkbox]").forEach(function(a){a.checked=b})}),!0}return!1}},{key:"getAllowedGroups",value:function getAllowedGroups(){return this.currentGroups}},{key:"isGroupAllowed",value:function isGroupAllowed(a){return this.currentGroups.includes(a)}},{key:"allowGroup",value:function allowGroup(a,b){var c=this.availableGroups;c.push(a),b?this.accept.apply(this,_toConsumableArray(c)):this.acceptWithoutAction.apply(this,_toConsumableArray(c))}},{key:"disableIntegration",value:function disableIntegration(a){this.toggleIntegration(a,0,function(a){return a.dataset.privacyContent=a.innerHTML,""})}},{key:"enableIntegration",value:function enableIntegration(a,b){var c=this;if(b){var d=a.closest(".cc_privacy_provider");if(!d)return;document.querySelectorAll(".cc_privacy_provider[data-privacy-group=\""+d.dataset.privacyGroup+"\"]").forEach(function(a){a!=d&&c.enableIntegration(a,!1)}),this.allowGroup(d.dataset.privacyGroup||"*",!1)}this.toggleIntegration(a,1,function(a){var b=a.dataset.privacyContent||"";return a.dataset.privacyContent="",b})}},{key:"toggleIntegration",value:function toggleIntegration(a,b,c){var d=a.closest(".cc_privacy_provider");if(d){var e=d.dataset.privacyState||0;if(e!=b){var f=d.querySelector(".cc_privacy_content"),g=new CustomEvent("PrivacylayerIntegrationStatePreToggle",{cancelable:!0,detail:{container:d,targetState:b}});if(document.dispatchEvent(g)){f&&(f.innerHTML=c(f)),d.dataset.privacyState=b+"";var h=new CustomEvent("PrivacylayerIntegrationStateToggled",{detail:{container:d,contentContainer:f,targetState:b}});document.dispatchEvent(h)}}}}}]),a}(),b),a.initialized=!0,window.privacylayer=a)}(window.privacylayer);